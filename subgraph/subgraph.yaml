specVersion: 0.0.4
description: NFT Derivative Token
repository: https://github.com/Meitaverse/noa
schema:
  file: ./schema.graphql
dataSources:
  - kind: ethereum/contract
    name: SBT
    network: mainnet
    source:
      abi: Events
      address: "0x0DCd1Bf9A1b36cE34237eEaFef220932846BCD82"
      startBlock: 1
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - ProfileCreated
        - MintSBTValue
        - BurnSBT
      abis:
        - name: Events
          file: ../artifacts/contracts/libraries/Events.sol/Events.json
        - name: SBT
          file: ../artifacts/contracts/NFTDerivativeProtocolTokenV1.sol/NFTDerivativeProtocolTokenV1.json
      eventHandlers:
        - event: ProfileCreated(indexed uint256,indexed address,indexed
            address,string,string,uint256)
          handler: handleProfileCreated
        - event: MintSBTValue(indexed address,indexed uint256,indexed uint256,uint256)
          handler: handleMintSBTValue
        - event: BurnSBT(indexed address,indexed uint256,indexed uint256,uint256)
          handler: handleBurnSBT
      file: ./src/sbt-mapping.ts
  - kind: ethereum/contract
    name: SBTERC3525
    network: mainnet
    source:
      abi: SBT
      address: "0x0DCd1Bf9A1b36cE34237eEaFef220932846BCD82"
      startBlock: 1
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - Approval
        - ApprovalForAll
        - ApprovalValue
        - Transfer
        - TransferValue
        - SlotChanged
      abis:
        - name: SBT
          file: ../artifacts/contracts/NFTDerivativeProtocolTokenV1.sol/NFTDerivativeProtocolTokenV1.json
      eventHandlers:
        - event: Approval(indexed address,indexed address,indexed uint256)
          handler: handleApproval
        - event: ApprovalForAll(indexed address,indexed address,bool)
          handler: handleApprovalForAll
        - event: ApprovalValue(indexed uint256,indexed address,uint256)
          handler: handleApprovalValue
        - event: Transfer(indexed address,indexed address,indexed uint256)
          handler: handleSBTTransfer
        - event: TransferValue(indexed uint256,indexed uint256,uint256)
          handler: handleSBTTransferValue
        - event: SlotChanged(indexed uint256,indexed uint256,indexed uint256)
          handler: handleSBTSlotChanged
      file: ./src/sbt-mapping.ts
  - kind: ethereum/contract
    name: Manager
    network: mainnet
    source:
      abi: Events
      address: "0xa513E6E4b8f2a923D98304ec87F64353C4D5C853"
      startBlock: 1
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - EmergencyAdminSet
        - ManagerGovernanceSet
        - HubCreated
        - HubUpdated
        - PublishPrepared
        - PublishUpdated
        - PublishCreated
        - DerivativeNFTDeployed
        - DerivativeNFTCollected
        - DerivativeNFTAirdroped
        - DispatcherSet
        - StateSet
      abis:
        - name: Manager
          file: ../artifacts/contracts/Manager.sol/Manager.json
        - name: Events
          file: ../artifacts/contracts/libraries/Events.sol/Events.json
      eventHandlers:
        - event: EmergencyAdminSet(indexed address,indexed address,indexed
            address,uint256)
          handler: handleEmergencyAdminSet
        - event: ManagerGovernanceSet(indexed address,indexed address,indexed
            address,uint256)
          handler: handleManagerGovernanceSet
        - event: HubCreated(indexed uint256,indexed address,indexed
            uint256,string,string,string,uint256)
          handler: handleHubCreated
        - event: HubUpdated(indexed address,string,string,string,uint256)
          handler: handleHubUpdated
        - event: PublishPrepared((uint256,uint256,uint256,uint256,uint256,uint256,string,string,bool,string[],uint256[],address,bytes,address,bytes),uint256,uint256,uint256)
          handler: handlePublishPrepared
        - event: PublishUpdated(uint256,uint256,uint256,uint256,uint256,uint256,uint256,string,string,string[],uint256[],uint256,uint256)
          handler: handlePublishUpdated
        - event: PublishCreated(indexed uint256,indexed uint256,uint256,uint256,indexed
            uint256,uint256,bytes,uint256)
          handler: handlePublishCreated
        - event: DerivativeNFTDeployed(address,indexed uint256,indexed
            uint256,address,uint256)
          handler: handleDerivativeNFTDeployed
        - event: DerivativeNFTCollected(uint256,address,indexed uint256,indexed
            uint256,indexed uint256,uint256,uint256,uint256)
          handler: handleDerivativeNFTCollected
        - event: DerivativeNFTAirdroped(uint256,address,indexed uint256,indexed
            uint256,uint256[],uint256[],uint256[],uint256)
          handler: handleDerivativeNFTAirdroped
        - event: DispatcherSet(indexed uint256,indexed address,uint256)
          handler: handleDispatcherSet
        - event: StateSet(indexed address,indexed uint8,indexed uint8,uint256)
          handler: handleStateSet
      file: ./src/manager-mapping.ts
  - kind: ethereum/contract
    name: BankTreasury
    network: mainnet
    source:
      abi: Events
      address: "0x9A9f2CCfdE556A7E9Ff0848998Aa4a0CFD8863AE"
      startBlock: 1
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - Deposit
        - DepositByFallback
        - ERC3525Received
        - ExchangeSBTByEth
        - ExchangeEthBySBT
        - SubmitTransaction
        - ConfirmTransaction
        - ExecuteTransaction
        - ExecuteTransactionERC3525
        - RevokeConfirmation
        - ExchangeVoucher
        - BalanceLocked
        - BalanceUnlocked
        - OfferWithdrawn
        - WithdrawnEarnestMoney
      abis:
        - name: SBT
          file: ../artifacts/contracts/NFTDerivativeProtocolTokenV1.sol/NFTDerivativeProtocolTokenV1.json
        - name: BankTreasury
          file: ../artifacts/contracts/BankTreasury.sol/BankTreasury.json
        - name: Events
          file: ../artifacts/contracts/libraries/Events.sol/Events.json
      eventHandlers:
        - event: Deposit(indexed address,uint256,indexed address,uint256)
          handler: handleDeposit
        - event: DepositByFallback(indexed address,uint256,bytes,indexed address,uint256)
          handler: handleDepositByFallback
        - event: ERC3525Received(indexed address,indexed uint256,indexed
            uint256,uint256,bytes,uint256)
          handler: handleERC3525Received
        - event: ExchangeSBTByEth(indexed uint256,indexed address,indexed uint256,uint256)
          handler: handleExchangeSBTByEth
        - event: ExchangeEthBySBT(indexed uint256,indexed address,indexed
            uint256,uint256,uint256,uint256)
          handler: handleExchangeEthBySBT
        - event: SubmitTransaction(indexed address,indexed uint256,indexed
            address,uint256,bytes)
          handler: handleSubmitTransaction
        - event: ConfirmTransaction(indexed address,indexed uint256)
          handler: handleConfirmTransaction
        - event: ExecuteTransaction(indexed address,indexed uint256,address,uint256)
          handler: handleExecuteTransaction
        - event: ExecuteTransactionERC3525(indexed address,indexed uint256,indexed
            uint256,uint256,uint256)
          handler: handleExecuteTransactionERC3525
        - event: RevokeConfirmation(indexed address,indexed uint256)
          handler: handleRevokeConfirmation
        - event: ExchangeVoucher(indexed uint256,indexed address,indexed
            uint256,uint256,uint256)
          handler: handleExchangeVoucher
        - event: BalanceLocked(indexed address,indexed uint256,indexed
            uint256,uint256,uint256)
          handler: handleBalanceLocked
        - event: BalanceUnlocked(indexed address,indexed uint256,indexed uint256,uint256)
          handler: handleBalanceUnlocked
        - event: OfferWithdrawn(indexed address,indexed uint256,address,indexed
            uint256,uint256)
          handler: handleOfferWithdrawn
        - event: WithdrawnEarnestMoney(indexed uint256,indexed address,indexed
            uint256,uint256)
          handler: handleWithdrawnEarnestMoney
      file: ./src/bankTreasury-mapping.ts
  - kind: ethereum/contract
    name: Voucher
    network: mainnet
    source:
      abi: Events
      address: "0x8A791620dd6260079BF849Dc5567aDC3F2FdC318"
      startBlock: 1
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - MintNFTVoucher
        - UserAmountLimitSet
        - GenerateVoucher
      abis:
        - name: Events
          file: ../artifacts/contracts/libraries/Events.sol/Events.json
      eventHandlers:
        - event: MintNFTVoucher(uint256,address,uint8,uint256,uint256,uint256)
          handler: handleMintNFTVoucher
        - event: UserAmountLimitSet(uint256,uint256,uint256)
          handler: handleUserAmountLimitSet
        - event: GenerateVoucher(uint8,uint256,uint256,uint256,uint256,uint256)
          handler: handleGenerateVoucher
      file: ./src/voucher-mapping.ts
  - kind: ethereum/contract
    name: VoucherERC1155
    network: mainnet
    source:
      abi: Voucher
      address: "0x8A791620dd6260079BF849Dc5567aDC3F2FdC318"
      startBlock: 1
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - TransferBatch
        - TransferSingle
      abis:
        - name: Voucher
          file: ../artifacts/contracts/Voucher.sol/Voucher.json
      eventHandlers:
        - event: TransferBatch(indexed address,indexed address,indexed
            address,uint256[],uint256[])
          handler: handleTransferBatch
        - event: TransferSingle(indexed address,indexed address,indexed
            address,uint256,uint256)
          handler: handleTransferSingle
      file: ./src/voucher-mapping.ts
  - kind: ethereum/contract
    name: ModuleGlobals
    network: mainnet
    source:
      abi: Events
      address: "0x59b670e9fA9D0A427751Af201D676719a970857b"
      startBlock: 1
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - CollectModuleWhitelisted
        - PublishModuleWhitelisted
        - TemplateWhitelisted
        - ProfileCreatorWhitelisted
        - HubCreatorWhitelisted
        - ModuleGlobalsTreasurySet
        - ModuleGlobalsVoucherSet
        - ModuleGlobalsManagerSet
        - ModuleGlobalsSBTSet
        - ModuleGlobalsGovernanceSet
        - ModuleGlobalsPublishRoyaltySet
        - ModuleGlobalsTreasuryFeeSet
      abis:
        - name: Events
          file: ../artifacts/contracts/libraries/Events.sol/Events.json
      eventHandlers:
        - event: ProfileCreatorWhitelisted(indexed address,indexed bool,indexed
            address,uint256)
          handler: handleProfileCreatorWhitelisted
        - event: HubCreatorWhitelisted(indexed uint256,indexed bool,indexed
            address,uint256)
          handler: handleHubCreatorWhitelisted
        - event: ModuleGlobalsTreasurySet(indexed address,indexed address,uint256)
          handler: handleModuleGlobalsTreasurySet
        - event: ModuleGlobalsVoucherSet(indexed address,indexed address,uint256)
          handler: handleModuleGlobalsVoucherSet
        - event: ModuleGlobalsManagerSet(indexed address,indexed address,uint256)
          handler: handleModuleGlobalsManagerSet
        - event: ModuleGlobalsSBTSet(indexed address,indexed address,uint256)
          handler: handleModuleGlobalsSBTSet
        - event: ModuleGlobalsPublishRoyaltySet(indexed uint256,indexed uint256,uint256)
          handler: handleModuleGlobalsPublishRoyaltySet
        - event: ModuleGlobalsTreasuryFeeSet(indexed uint16,indexed uint16,uint256)
          handler: handleModuleGlobalsTreasuryFeeSet
        - event: ModuleGlobalsGovernanceSet(indexed address,indexed address,uint256)
          handler: handleModuleGlobalsGovernanceSet
        - event: CollectModuleWhitelisted(indexed address,indexed bool,uint256)
          handler: handleCollectModuleWhitelisted
        - event: PublishModuleWhitelisted(indexed address,indexed bool,uint256)
          handler: handlePublishModuleWhitelisted
        - event: TemplateWhitelisted(indexed address,indexed bool,uint256)
          handler: handleTemplateWhitelisted
      file: ./src/moduleGlobals-mapping.ts
  - kind: ethereum/contract
    name: FeeCollectModule
    network: mainnet
    source:
      abi: Events
      address: "0x322813Fd9A801c5507c9de605d63CEA4f2CE6c44"
      startBlock: 1
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - FeesForCollect
      abis:
        - name: ModuleGlobals
          file: ../artifacts/contracts/modules/ModuleGlobals.sol/ModuleGlobals.json
        - name: FeeCollectModule
          file: ../artifacts/contracts/modules/collect/FeeCollectModule.sol/FeeCollectModule.json
        - name: SBT
          file: ../artifacts/contracts/NFTDerivativeProtocolTokenV1.sol/NFTDerivativeProtocolTokenV1.json
        - name: Events
          file: ../artifacts/contracts/libraries/Events.sol/Events.json
      eventHandlers:
        - event: FeesForCollect(uint256,uint256,uint256,(uint256,uint256,uint256,uint256,uint256),(uint256,uint256,uint256,uint256,uint256))
          handler: handleFeesForCollect
      file: ./src/feeCollectModule-mapping.ts
  - kind: ethereum/contract
    name: Receiver
    network: mainnet
    source:
      abi: Events
      address: "0x9fE46736679d2D9a65F0992F2272dE9f3c7fa6e0"
      startBlock: 1
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - ReceiverReceived
      abis:
        - name: Events
          file: ../artifacts/contracts/libraries/Events.sol/Events.json
      eventHandlers:
        - event: ReceiverReceived(indexed address,indexed uint256,indexed
            uint256,uint256,bytes,uint256)
          handler: handleReceiverReceived
      file: ./src/receiver-mapping.ts
  - kind: ethereum/contract
    name: MarketPlace
    network: mainnet
    source:
      abi: Events
      address: "0xc6e7DF5E7b4f2A278906862b61205850344D4e7d"
      startBlock: 1
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - MarketPlaceERC3525Received
        - AddMarket
        - RemoveMarket
        - ReserveAuctionBidPlaced
        - ReserveAuctionCanceled
        - ReserveAuctionCreated
        - ReserveAuctionFinalized
        - ReserveAuctionInvalidated
        - ReserveAuctionUpdated
        - OfferMade
        - OfferAccepted
        - OfferInvalidated
        - BuyPriceSet
        - BuyPriceCanceled
        - BuyPriceInvalidated
        - BuyPriceAccepted
      abis:
        - name: DerivativeNFT
          file: ../artifacts/contracts/DerivativeNFT.sol/DerivativeNFT.json
        - name: MarketPlace
          file: ../artifacts/contracts/MarketPlace.sol/MarketPlace.json
        - name: Events
          file: ../artifacts/contracts/libraries/Events.sol/Events.json
      eventHandlers:
        - event: MarketPlaceERC3525Received(indexed address,indexed uint256,indexed
            uint256,uint256,bytes,uint256)
          handler: handleMarketPlaceERC3525Received
        - event: AddMarket(address,uint8,uint8,uint16)
          handler: handleAddMarket
        - event: RemoveMarket(address)
          handler: handleRemoveMarket
        - event: ReserveAuctionBidPlaced(indexed uint256,indexed uint256,indexed
            uint256,address,uint256,uint256)
          handler: handleReserveAuctionBidPlaced
        - event: ReserveAuctionCanceled(indexed uint256)
          handler: handleReserveAuctionCanceled
        - event: ReserveAuctionCreated(indexed address,indexed address,indexed
            uint256,uint256,uint256,uint256,uint256,uint256,uint256)
          handler: handleReserveAuctionCreated
        - event: ReserveAuctionFinalized(indexed uint256,indexed address,indexed
            address,(uint256,uint256,uint256,uint256,uint256))
          handler: handleReserveAuctionFinalized
        - event: ReserveAuctionInvalidated(indexed uint256)
          handler: handleReserveAuctionInvalidated
        - event: ReserveAuctionUpdated(indexed uint256,uint256)
          handler: handleReserveAuctionUpdated
        - event: OfferMade(indexed address,indexed uint256,indexed
            address,uint256,uint256)
          handler: handleOfferMade
        - event: OfferAccepted(indexed address,indexed uint256,indexed
            address,address,(uint256,uint256,uint256,uint256,uint256))
          handler: handleOfferAccepted
        - event: OfferInvalidated(indexed address,indexed uint256)
          handler: handleOfferInvalidated
        - event: BuyPriceSet((uint256,address,address,uint256,uint256,uint256,uint256,uint32,uint128,uint128,uint128),indexed
            address)
          handler: handleBuyPriceSet
        - event: BuyPriceCanceled(indexed address,indexed uint256)
          handler: handleBuyPriceCanceled
        - event: BuyPriceInvalidated(indexed address,indexed uint256)
          handler: handleBuyPriceInvalidated
        - event: BuyPriceAccepted(indexed address,indexed uint256,indexed
            uint256,address,address,(uint256,uint256,uint256,uint256,uint256),(uint256,uint256,uint256,uint256,uint256))
          handler: handleBuyPriceAccepted
      file: ./src/marketplace-mapping.ts
