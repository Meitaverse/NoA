specVersion: 0.0.4
description: NFT Derivative Token
repository: https://github.com/Meitaverse/noa
schema:
  file: ./schema.graphql
dataSources:
  - kind: ethereum/contract
    name: SBT
    network: mainnet
    source:
      address: "0xB7f8BC63BbcaD18155201308C8f3540b07f84F5e"
      abi: Events
      startBlock: 0
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - BankTreasurySet
        - ProfileCreated
        - MintSBTValue
        - BurnSBT
        - BurnSBTValue
        - ProfileImageURISet
        - ApprovalForSlot
      abis:
        - name: SBT
          file: ./abis/SBT.json
        - name: Events
          file: ./abis/Events.json
      eventHandlers:
        - event: BankTreasurySet(indexed uint256,indexed address,indexed uint256,uint256)
          handler: handleBankTreasurySet
        - event: ProfileCreated(indexed uint256,indexed address,indexed address,string,string,uint256)
          handler: handleProfileCreated
        - event: MintSBTValue(uint256,uint256,uint256)
          handler: handleMintSBTValue
        - event: BurnSBT(uint256,uint256)
          handler: handleBurnSBT
        - event: BurnSBTValue(uint256,uint256,uint256)
          handler: handleBurnSBTValue
        - event: ProfileImageURISet(indexed uint256,string,uint256)
          handler: handleProfileImageURISet
        - event: ApprovalForSlot(indexed address,indexed uint256,indexed address,bool)
          handler: handleApprovalForSlot
      file: ./src/sbt-mapping.ts

  - kind: ethereum/contract
    name: Manager
    network: mainnet
    source:
      address: "0xa513E6E4b8f2a923D98304ec87F64353C4D5C853"
      abi: Events
      startBlock: 0
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - EmergencyAdminSet
        - TransferDerivativeNFT
        - TransferValueDerivativeNFT
        - HubCreated
        - PublishPrepared
        - PublishCreated
        - DerivativeNFTDeployed
        - DerivativeNFTCollected
        - DerivativeNFTAirdroped
        - DispatcherSet
        - StateSet
      abis:
        - name: Events
          file: ./abis/Events.json
      eventHandlers:
        - event: EmergencyAdminSet(indexed address,indexed address,indexed address,uint256)
          handler: handleEmergencyAdminSet
        - event: TransferDerivativeNFT(uint256,uint256,uint256,uint256,uint256)
          handler: handleTransferDerivativeNFT
        - event: TransferValueDerivativeNFT(uint256,uint256,uint256,uint256,uint256,uint256,uint256)
          handler: handleTransferValueDerivativeNFT
        - event: HubCreated(indexed uint256,indexed address,indexed uint256,string,string,string,uint256)
          handler: handleHubCreated
        - event: PublishPrepared((uint256,uint256,uint256,uint256,uint256,uint256,string,string,string[],uint256[],address,bytes,address,bytes),uint256,uint256,uint256,uint256)
          handler: handlePublishPrepared
        - event: PublishCreated(uint256,uint256,uint256,uint256,uint256,uint256,bytes,uint256)
          handler: handlePublishCreated
        - event: DerivativeNFTDeployed(indexed uint256,indexed uint256,address,uint256)
          handler: handleDerivativeNFTDeployed
        - event: DerivativeNFTCollected(uint256,address,uint256,uint256,uint256,uint256,uint256,uint256)
          handler: handleDerivativeNFTCollected
        - event: DerivativeNFTAirdroped(uint256,address,uint256,uint256,uint256[],uint256[],uint256[],uint256)
          handler: handleDerivativeNFTAirdroped
        - event:  DispatcherSet(indexed uint256,indexed address,uint256)
          handler: handleDispatcherSet
        - event:  StateSet(indexed address,indexed uint8,indexed uint8,uint256)
          handler: handleStateSet
      file: ./src/manager-mapping.ts

  - kind: ethereum/contract
    name: BankTreasury
    network: mainnet
    source:
      address: "0x0DCd1Bf9A1b36cE34237eEaFef220932846BCD82"
      abi: Events
      startBlock: 0
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - ERC3525Received
        - ExchangeSBTByEth
        - ExchangeEthBySBT
      abis:
        - name: Events
          file: ./abis/Events.json
      eventHandlers:
        - event: ERC3525Received(address,uint256,uint256,uint256,bytes,uint256)
          handler: handleERC3525Received
        - event: ExchangeSBTByEth(indexed uint256,indexed address,indexed uint256,uint256)
          handler: handleExchangeSBTByEth
        - event: ExchangeEthBySBT(indexed uint256,indexed address,indexed uint256,uint256,uint256,uint256)
          handler: handleExchangeSBTByEth
      file: ./src/bankTreasury-mapping.ts
  
  - kind: ethereum/contract
    name: Voucher
    network: mainnet
    source:
      address: "0x8A791620dd6260079BF849Dc5567aDC3F2FdC318"
      abi: Events
      startBlock: 0
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - MintNFTVoucher
        - UserAmountLimitSet
        - GenerateVoucher
      abis:
        - name: Events
          file: ./abis/Events.json
      eventHandlers:
        - event: MintNFTVoucher(uint256,address,uint8,uint256,uint256,uint256)
          handler: handleMintNFTVoucher
        - event: UserAmountLimitSet(uint256,uint256,uint256)
          handler: handleUserAmountLimitSet
        - event: GenerateVoucher(uint8,uint256,uint256,uint256,uint256,uint256)
          handler: handleGenerateVoucher
      file: ./src/voucher-mapping.ts

  - kind: ethereum/contract
    name: ModuleGlobals
    network: mainnet
    source:
      address: "0x9A676e781A523b5d0C0e43731313A708CB607508"
      abi: Events
      startBlock: 0
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - ProfileCreatorWhitelisted
        - HubCreatorWhitelisted
        - ModuleGlobalsTreasurySet
        - ModuleGlobalsVoucherSet
        - ModuleGlobalsManagerSet
        - ModuleGlobalsSBTSet
        - ModuleGlobalsPublishRoyaltySet
        - ModuleGlobalsTreasuryFeeSet
        - ModuleGlobalsGovernanceSet
        - CollectModuleWhitelisted
        - PublishModuleWhitelisted
        - TemplateWhitelisted
      abis:
        - name: Events
          file: ./abis/Events.json
      eventHandlers:
        - event: ProfileCreatorWhitelisted(indexed address,indexed bool,uint256)
          handler: handleProfileCreatorWhitelisted
        - event: HubCreatorWhitelisted(indexed uint256,indexed bool,uint256)
          handler: handleHubCreatorWhitelisted
        - event: ModuleGlobalsTreasurySet(indexed address,indexed address,uint256)
          handler: handleModuleGlobalsTreasurySet
        - event: ModuleGlobalsVoucherSet(indexed address,indexed address,uint256)
          handler: handleModuleGlobalsVoucherSet
        - event: ModuleGlobalsManagerSet(indexed address,indexed address,uint256)
          handler: handleModuleGlobalsManagerSet
        - event: ModuleGlobalsSBTSet(indexed address,indexed address,uint256)
          handler: handleModuleGlobalsSBTSet
        - event: ModuleGlobalsPublishRoyaltySet(indexed uint256,indexed uint256,uint256)
          handler: handleModuleGlobalsPublishRoyaltySet
        - event: ModuleGlobalsTreasuryFeeSet(indexed uint16,indexed uint16,uint256)
          handler: handleModuleGlobalsTreasuryFeeSet
        - event: ModuleGlobalsGovernanceSet(indexed address,indexed address,uint256)
          handler: handleModuleGlobalsGovernanceSet
        - event: CollectModuleWhitelisted(indexed address,indexed bool,uint256)
          handler: handleCollectModuleWhitelisted
        - event: PublishModuleWhitelisted(indexed address,indexed bool,uint256)
          handler: handlePublishModuleWhitelisted
        - event: TemplateWhitelisted(indexed address,indexed bool,uint256)
          handler: handleTemplateWhitelisted
      file: ./src/moduleGlobals-mapping.ts

  - kind: ethereum/contract
    name: FeeCollectModule
    network: mainnet
    source:
      address: "0x0B306BF915C4d645ff596e518fAf3F9669b97016"
      abi: Events
      startBlock: 0
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - FeesForCollect
      abis:
        - name: Events
          file: ./abis/Events.json
      eventHandlers:
        - event: FeesForCollect(uint256,(uint256,uint256,uint256,uint256),(uint256,uint256,uint256,uint256))
          handler: handleFeesForCollect
      file: ./src/feeCollectModule-mapping.ts

  - kind: ethereum/contract
    name: Receiver
    network: mainnet
    source:
      address: "0x9fE46736679d2D9a65F0992F2272dE9f3c7fa6e0"
      abi: Events
      startBlock: 0
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - ReceiverReceived
      abis:
        - name: Events
          file: ./abis/Events.json
      eventHandlers:
        - event: ReceiverReceived(address,uint256,uint256,uint256,bytes,uint256)
          handler: handleReceiverReceived
      file: ./src/receiver-mapping.ts


  - kind: ethereum/contract
    name: MarketPlace
    network: mainnet
    source:
      address: "0x9A676e781A523b5d0C0e43731313A708CB607508"
      abi: Events
      startBlock: 0
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - AddMarket
      abis:
        - name: Events
          file: ./abis/Events.json
      eventHandlers:
        - event: AddMarket(address,uint8,uint8,uint16)
          handler: handleAddMarket
      file: ./src/marketplace-mapping.ts
